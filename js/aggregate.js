var nextSpawnInterval,uniformRandom;THREE.OBJLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager,this.materials=null,this.regexp={vertex_pattern:/^v\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,normal_pattern:/^vn\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,uv_pattern:/^vt\s+([\d|\.|\+|\-|e|E]+)\s+([\d|\.|\+|\-|e|E]+)/,face_vertex:/^f\s+(-?\d+)\s+(-?\d+)\s+(-?\d+)(?:\s+(-?\d+))?/,face_vertex_uv:/^f\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+))?/,face_vertex_uv_normal:/^f\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)\s+(-?\d+)\/(-?\d+)\/(-?\d+)(?:\s+(-?\d+)\/(-?\d+)\/(-?\d+))?/,face_vertex_normal:/^f\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)\s+(-?\d+)\/\/(-?\d+)(?:\s+(-?\d+)\/\/(-?\d+))?/,object_pattern:/^[og]\s*(.+)?/,smoothing_pattern:/^s\s+(\d+|on|off)/,material_library_pattern:/^mtllib /,material_use_pattern:/^usemtl /}},THREE.OBJLoader.prototype={constructor:THREE.OBJLoader,load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader(e.manager);f.setPath(this.path),f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a},setMaterials:function(a){this.materials=a},_createParserState:function(){var a={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(a,b){var c,d;return this.object&&this.object.fromDeclaration===!1?(this.object.name=a,this.object.fromDeclaration=b!==!1,void 0):(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(),c=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0,this.object={name:a||"",fromDeclaration:b!==!1,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var d,c=this._finalize(!1);return c&&(c.inherited||c.groupCount<=0)&&this.materials.splice(c.index,1),d={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&b.length>0?b[b.length-1]:"",smooth:void 0!==c?c.smooth:this.smooth,groupStart:void 0!==c?c.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){return{index:"number"==typeof a?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:this.groupEnd,groupEnd:-1,groupCount:-1,inherited:!1}}},this.materials.push(d),d},currentMaterial:function(){return this.materials.length>0?this.materials[this.materials.length-1]:void 0},_finalize:function(a){var b=this.currentMaterial();return b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1),a!==!1&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),b}},c&&c.name&&"function"==typeof c.clone&&(d=c.clone(0),d.inherited=!0,this.object.materials.push(d)),this.objects.push(this.object),void 0)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize()},parseVertexIndex:function(a,b){var c=parseInt(a,10);return 3*(c>=0?c-1:c+b/3)},parseNormalIndex:function(a,b){var c=parseInt(a,10);return 3*(c>=0?c-1:c+b/3)},parseUVIndex:function(a,b){var c=parseInt(a,10);return 2*(c>=0?c-1:c+b/2)},addVertex:function(a,b,c){var d=this.vertices,e=this.object.geometry.vertices;e.push(d[a+0]),e.push(d[a+1]),e.push(d[a+2]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[b+2]),e.push(d[c+0]),e.push(d[c+1]),e.push(d[c+2])},addVertexLine:function(a){var b=this.vertices,c=this.object.geometry.vertices;c.push(b[a+0]),c.push(b[a+1]),c.push(b[a+2])},addNormal:function(a,b,c){var d=this.normals,e=this.object.geometry.normals;e.push(d[a+0]),e.push(d[a+1]),e.push(d[a+2]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[b+2]),e.push(d[c+0]),e.push(d[c+1]),e.push(d[c+2])},addUV:function(a,b,c){var d=this.uvs,e=this.object.geometry.uvs;e.push(d[a+0]),e.push(d[a+1]),e.push(d[b+0]),e.push(d[b+1]),e.push(d[c+0]),e.push(d[c+1])},addUVLine:function(a){var b=this.uvs,c=this.object.geometry.uvs;c.push(b[a+0]),c.push(b[a+1])},addFace:function(a,b,c,d,e,f,g,h,i,j,k,l){var q,r,s,m=this.vertices.length,n=this.parseVertexIndex(a,m),o=this.parseVertexIndex(b,m),p=this.parseVertexIndex(c,m);void 0===d?this.addVertex(n,o,p):(q=this.parseVertexIndex(d,m),this.addVertex(n,o,q),this.addVertex(o,p,q)),void 0!==e&&(r=this.uvs.length,n=this.parseUVIndex(e,r),o=this.parseUVIndex(f,r),p=this.parseUVIndex(g,r),void 0===d?this.addUV(n,o,p):(q=this.parseUVIndex(h,r),this.addUV(n,o,q),this.addUV(o,p,q))),void 0!==i&&(s=this.normals.length,n=this.parseNormalIndex(i,s),o=i===j?n:this.parseNormalIndex(j,s),p=i===k?n:this.parseNormalIndex(k,s),void 0===d?this.addNormal(n,o,p):(q=this.parseNormalIndex(l,s),this.addNormal(n,o,q),this.addNormal(o,p,q)))},addLineGeometry:function(a,b){var c,d,e,f,g;for(this.object.geometry.type="Line",c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;f>e;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));for(g=0,f=b.length;f>g;g++)this.addUVLine(this.parseUVIndex(b[g],d))}};return a.startObject("",!1),a},parse:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G;for(console.time("OBJLoader"),b=this._createParserState(),-1!==a.indexOf("\r\n")&&(a=a.replace("\r\n","\n")),c=a.split("\n"),d="",e="",f="",g=0,h=[],i="function"==typeof"".trimLeft,j=0,k=c.length;k>j;j++)if(d=c[j],d=i?d.trimLeft():d.trim(),g=d.length,0!==g&&(e=d.charAt(0),"#"!==e))if("v"===e)if(f=d.charAt(1)," "===f&&null!==(h=this.regexp.vertex_pattern.exec(d)))b.vertices.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));else if("n"===f&&null!==(h=this.regexp.normal_pattern.exec(d)))b.normals.push(parseFloat(h[1]),parseFloat(h[2]),parseFloat(h[3]));else{if("t"!==f||null===(h=this.regexp.uv_pattern.exec(d)))throw new Error("Unexpected vertex/normal/uv line: '"+d+"'");b.uvs.push(parseFloat(h[1]),parseFloat(h[2]))}else if("f"===e)if(null!==(h=this.regexp.face_vertex_uv_normal.exec(d)))b.addFace(h[1],h[4],h[7],h[10],h[2],h[5],h[8],h[11],h[3],h[6],h[9],h[12]);else if(null!==(h=this.regexp.face_vertex_uv.exec(d)))b.addFace(h[1],h[3],h[5],h[7],h[2],h[4],h[6],h[8]);else if(null!==(h=this.regexp.face_vertex_normal.exec(d)))b.addFace(h[1],h[3],h[5],h[7],void 0,void 0,void 0,void 0,h[2],h[4],h[6],h[8]);else{if(null===(h=this.regexp.face_vertex.exec(d)))throw new Error("Unexpected face line: '"+d+"'");b.addFace(h[1],h[2],h[3],h[4])}else if("l"===e){if(l=d.substring(1).trim().split(" "),m=[],n=[],-1===d.indexOf("/"))m=l;else for(o=0,p=l.length;p>o;o++)q=l[o].split("/"),""!==q[0]&&m.push(q[0]),""!==q[1]&&n.push(q[1]);b.addLineGeometry(m,n)}else if(null!==(h=this.regexp.object_pattern.exec(d)))r=h[0].substr(1).trim(),b.startObject(r);else if(this.regexp.material_use_pattern.test(d))b.object.startMaterial(d.substring(7).trim(),b.materialLibraries);else if(this.regexp.material_library_pattern.test(d))b.materialLibraries.push(d.substring(7).trim());else{if(null===(h=this.regexp.smoothing_pattern.exec(d))){if("\0"===d)continue;throw new Error("Unexpected line: '"+d+"'")}s=h[1].trim().toLowerCase(),b.object.smooth="1"===s||"on"===s,t=b.object.currentMaterial(),t&&(t.smooth=b.object.smooth)}for(b.finalize(),u=new THREE.Group,u.materialLibraries=[].concat(b.materialLibraries),j=0,k=b.objects.length;k>j;j++)if(v=b.objects[j],w=v.geometry,x=v.materials,y="Line"===w.type,0!==w.vertices.length){for(z=new THREE.BufferGeometry,z.addAttribute("position",new THREE.BufferAttribute(new Float32Array(w.vertices),3)),w.normals.length>0?z.addAttribute("normal",new THREE.BufferAttribute(new Float32Array(w.normals),3)):z.computeVertexNormals(),w.uvs.length>0&&z.addAttribute("uv",new THREE.BufferAttribute(new Float32Array(w.uvs),2)),A=[],B=0,C=x.length;C>B;B++)D=x[B],t=void 0,null!==this.materials&&(t=this.materials.create(D.name),!y||!t||t instanceof THREE.LineBasicMaterial||(E=new THREE.LineBasicMaterial,E.copy(t),t=E)),t||(t=y?new THREE.LineBasicMaterial:new THREE.MeshPhongMaterial,t.name=D.name),t.shading=D.smooth?THREE.SmoothShading:THREE.FlatShading,A.push(t);if(A.length>1){for(B=0,C=x.length;C>B;B++)D=x[B],z.addGroup(D.groupStart,D.groupCount,B);G=new THREE.MultiMaterial(A),F=y?new THREE.LineSegments(z,G):new THREE.Mesh(z,G)}else F=y?new THREE.LineSegments(z,A[0]):new THREE.Mesh(z,A[0]);F.name=v.name,u.add(F)}return console.timeEnd("OBJLoader"),u}},THREE.MTLLoader=function(a){this.manager=void 0!==a?a:THREE.DefaultLoadingManager},Object.assign(THREE.MTLLoader.prototype,THREE.EventDispatcher.prototype,{load:function(a,b,c,d){var e=this,f=new THREE.XHRLoader(this.manager);f.setPath(this.path),f.load(a,function(a){b(e.parse(a))},c,d)},setPath:function(a){this.path=a},setTexturePath:function(a){this.texturePath=a},setBaseUrl:function(a){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(a)},setCrossOrigin:function(a){this.crossOrigin=a},setMaterialOptions:function(a){this.materialOptions=a},parse:function(a){var f,g,h,i,j,k,l,b=a.split("\n"),c={},d=/\s+/,e={};for(f=0;f<b.length;f++)g=b[f],g=g.trim(),0!==g.length&&"#"!==g.charAt(0)&&(h=g.indexOf(" "),i=h>=0?g.substring(0,h):g,i=i.toLowerCase(),j=h>=0?g.substring(h+1):"",j=j.trim(),"newmtl"===i?(c={name:j},e[j]=c):c&&("ka"===i||"kd"===i||"ks"===i?(k=j.split(d,3),c[i]=[parseFloat(k[0]),parseFloat(k[1]),parseFloat(k[2])]):c[i]=j));return l=new THREE.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions),l.setCrossOrigin(this.crossOrigin),l.setManager(this.manager),l.setMaterials(e),l}}),THREE.MTLLoader.MaterialCreator=function(a,b){this.baseUrl=a||"",this.options=b,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:THREE.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:THREE.RepeatWrapping},THREE.MTLLoader.MaterialCreator.prototype={constructor:THREE.MTLLoader.MaterialCreator,setCrossOrigin:function(a){this.crossOrigin=a},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){var b,c,d,e,f,g,h,i;if(!this.options)return a;b={};for(c in a){d=a[c],e={},b[c]=e;for(f in d){switch(g=!0,h=d[f],i=f.toLowerCase()){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[2]&&(g=!1)}g&&(e[i]=h)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var b,a=0;for(b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(a){function f(a,c){var f,g;d[a]||(f=b.getTextureParams(c,d),g=b.loadTexture(e(b.baseUrl,f.url)),g.repeat.copy(f.scale),g.offset.copy(f.offset),g.wrapS=b.wrap,g.wrapT=b.wrap,d[a]=g)}var g,h,b=this,c=this.materialsInfo[a],d={name:a,side:this.side},e=function(a,b){return"string"!=typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b};for(g in c)if(h=c[g],""!==h)switch(g.toLowerCase()){case"kd":d.color=(new THREE.Color).fromArray(h);break;case"ks":d.specular=(new THREE.Color).fromArray(h);break;case"map_kd":f("map",h);break;case"map_ks":f("specularMap",h);break;case"map_bump":case"bump":f("bumpMap",h);break;case"ns":d.shininess=parseFloat(h);break;case"d":1>h&&(d.opacity=h,d.transparent=!0);break;case"Tr":h>0&&(d.opacity=1-h,d.transparent=!0)}return this.materials[a]=new THREE.MeshPhongMaterial(d),this.materials[a]},getTextureParams:function(a,b){var c={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},d=a.split(/\s+/),e=d.indexOf("-bm");return e>=0&&(b.bumpScale=parseFloat(d[e+1]),d.splice(e,2)),e=d.indexOf("-s"),e>=0&&(c.scale.set(parseFloat(d[e+1]),parseFloat(d[e+2])),d.splice(e,4)),e=d.indexOf("-o"),e>=0&&(c.offset.set(parseFloat(d[e+1]),parseFloat(d[e+2])),d.splice(e,4)),c.url=d.join(" ").trim(),c},loadTexture:function(a,b,c,d,e){var f,g=THREE.Loader.Handlers.get(a),h=void 0!==this.manager?this.manager:THREE.DefaultLoadingManager;return null===g&&(g=new THREE.TextureLoader(h)),g.setCrossOrigin&&g.setCrossOrigin(this.crossOrigin),f=g.load(a,c,d,e),void 0!==b&&(f.mapping=b),f}},THREE.BinaryLoader=function(a){"boolean"==typeof a&&(console.warn("THREE.BinaryLoader: showStatus parameter has been removed from constructor."),a=void 0),this.manager=void 0!==a?a:THREE.DefaultLoadingManager},THREE.BinaryLoader.prototype={constructor:THREE.BinaryLoader,load:function(a,b,c,d){var e=this.texturePath||THREE.Loader.prototype.extractUrlBase(a),f=this.binaryPath||THREE.Loader.prototype.extractUrlBase(a),g=this,h=new THREE.XHRLoader(this.manager);h.load(a,function(a){var h=JSON.parse(a),i=f+h.buffers,j=new THREE.XHRLoader(g.manager);j.setResponseType("arraybuffer"),j.load(i,function(a){g.parse(a,b,e,h.materials)},c,d)},c,d)},setBinaryPath:function(a){this.binaryPath=a},setCrossOrigin:function(a){this.crossOrigin=a},setTexturePath:function(a){this.texturePath=a},parse:function(a,b,c,d){var f,g,e=function(){function z(a){return a%4?4-a%4:0}function A(a,b){var c={signature:B(a,b,12),header_bytes:C(a,b+12),vertex_coordinate_bytes:C(a,b+13),normal_coordinate_bytes:C(a,b+14),uv_coordinate_bytes:C(a,b+15),vertex_index_bytes:C(a,b+16),normal_index_bytes:C(a,b+17),uv_index_bytes:C(a,b+18),material_index_bytes:C(a,b+19),nvertices:D(a,b+20),nnormals:D(a,b+20+4),nuvs:D(a,b+20+8),ntri_flat:D(a,b+20+12),ntri_smooth:D(a,b+20+16),ntri_flat_uv:D(a,b+20+20),ntri_smooth_uv:D(a,b+20+24),nquad_flat:D(a,b+20+28),nquad_smooth:D(a,b+20+32),nquad_flat_uv:D(a,b+20+36),nquad_smooth_uv:D(a,b+20+40)};return c}function B(a,b,c){var f,d=new Uint8Array(a,b,c),e="";for(f=0;c>f;f++)e+=String.fromCharCode(d[b+f]);return e}function C(a,b){var c=new Uint8Array(a,b,1);return c[0]}function D(a,b){var c=new Uint32Array(a,b,1);return c[0]}function E(b){var g,h,i,j,d=e.nvertices,f=new Float32Array(a,b,3*d);for(g=0;d>g;g++)h=f[3*g],i=f[3*g+1],j=f[3*g+2],c.vertices.push(new THREE.Vector3(h,i,j));return 3*d*Float32Array.BYTES_PER_ELEMENT}function F(b){var d,g,h,i,j,c=e.nnormals;if(c)for(d=new Int8Array(a,b,3*c),g=0;c>g;g++)h=d[3*g],i=d[3*g+1],j=d[3*g+2],f.push(h/127,i/127,j/127);return 3*c*Int8Array.BYTES_PER_ELEMENT}function G(b){var d,f,h,i,c=e.nuvs;if(c)for(d=new Float32Array(a,b,2*c),f=0;c>f;f++)h=d[2*f],i=d[2*f+1],g.push(h,i);return 2*c*Float32Array.BYTES_PER_ELEMENT}function H(b,d){var e,f,h,i,j,k,l,m,n,o,p=new Uint32Array(a,d,3*b);for(e=0;b>e;e++)f=p[3*e],h=p[3*e+1],i=p[3*e+2],j=g[2*f],m=g[2*f+1],k=g[2*h],n=g[2*h+1],l=g[2*i],o=g[2*i+1],c.faceVertexUvs[0].push([new THREE.Vector2(j,m),new THREE.Vector2(k,n),new THREE.Vector2(l,o)])}function I(b,d){var e,f,h,i,j,k,l,m,n,o,p,q,r,s=new Uint32Array(a,d,4*b);for(e=0;b>e;e++)f=s[4*e],h=s[4*e+1],i=s[4*e+2],j=s[4*e+3],k=g[2*f],o=g[2*f+1],l=g[2*h],p=g[2*h+1],m=g[2*i],q=g[2*i+1],n=g[2*j],r=g[2*j+1],c.faceVertexUvs[0].push([new THREE.Vector2(k,o),new THREE.Vector2(l,p),new THREE.Vector2(n,r)]),c.faceVertexUvs[0].push([new THREE.Vector2(l,p),new THREE.Vector2(m,q),new THREE.Vector2(n,r)])}function J(b,d,e){var f,g,h,i,j,k=new Uint32Array(a,d,3*b),l=new Uint16Array(a,e,b);for(f=0;b>f;f++)g=k[3*f],h=k[3*f+1],i=k[3*f+2],j=l[f],c.faces.push(new THREE.Face3(g,h,i,null,null,j))}function K(b,d,e){var f,g,h,i,j,k,l=new Uint32Array(a,d,4*b),m=new Uint16Array(a,e,b);for(f=0;b>f;f++)g=l[4*f],h=l[4*f+1],i=l[4*f+2],j=l[4*f+3],k=m[f],c.faces.push(new THREE.Face3(g,h,j,null,null,k)),c.faces.push(new THREE.Face3(h,i,j,null,null,k))}function L(b,d,e,g){var h,i,j,k,l,m,n,o,s,t,u,v,w,x,y,z,A,p=new Uint32Array(a,d,3*b),q=new Uint32Array(a,e,3*b),r=new Uint16Array(a,g,b);for(h=0;b>h;h++)i=p[3*h],j=p[3*h+1],k=p[3*h+2],m=q[3*h],n=q[3*h+1],o=q[3*h+2],l=r[h],s=f[3*m],t=f[3*m+1],u=f[3*m+2],v=f[3*n],w=f[3*n+1],x=f[3*n+2],y=f[3*o],z=f[3*o+1],A=f[3*o+2],c.faces.push(new THREE.Face3(i,j,k,[new THREE.Vector3(s,t,u),new THREE.Vector3(v,w,x),new THREE.Vector3(y,z,A)],null,l))}function M(b,d,e,g){var h,i,j,k,l,m,n,o,p,q,u,v,w,x,y,z,A,B,C,D,E,F,r=new Uint32Array(a,d,4*b),s=new Uint32Array(a,e,4*b),t=new Uint16Array(a,g,b);for(h=0;b>h;h++)i=r[4*h],j=r[4*h+1],k=r[4*h+2],l=r[4*h+3],n=s[4*h],o=s[4*h+1],p=s[4*h+2],q=s[4*h+3],m=t[h],u=f[3*n],v=f[3*n+1],w=f[3*n+2],x=f[3*o],y=f[3*o+1],z=f[3*o+2],A=f[3*p],B=f[3*p+1],C=f[3*p+2],D=f[3*q],E=f[3*q+1],F=f[3*q+2],c.faces.push(new THREE.Face3(i,j,l,[new THREE.Vector3(u,v,w),new THREE.Vector3(x,y,z),new THREE.Vector3(D,E,F)],null,m)),c.faces.push(new THREE.Face3(j,k,l,[new THREE.Vector3(x,y,z),new THREE.Vector3(A,B,C),new THREE.Vector3(D,E,F)],null,m))}function N(a){var c,b=e.ntri_flat;b&&(c=a+3*b*Uint32Array.BYTES_PER_ELEMENT,J(b,a,c))}function O(a){var c,d,b=e.ntri_flat_uv;b&&(c=a+3*b*Uint32Array.BYTES_PER_ELEMENT,d=c+3*b*Uint32Array.BYTES_PER_ELEMENT,J(b,a,d),H(b,c))}function P(a){var c,d,b=e.ntri_smooth;b&&(c=a+3*b*Uint32Array.BYTES_PER_ELEMENT,d=c+3*b*Uint32Array.BYTES_PER_ELEMENT,L(b,a,c,d))}function Q(a){var c,d,f,b=e.ntri_smooth_uv;b&&(c=a+3*b*Uint32Array.BYTES_PER_ELEMENT,d=c+3*b*Uint32Array.BYTES_PER_ELEMENT,f=d+3*b*Uint32Array.BYTES_PER_ELEMENT,L(b,a,c,f),H(b,d))}function R(a){var c,b=e.nquad_flat;b&&(c=a+4*b*Uint32Array.BYTES_PER_ELEMENT,K(b,a,c))}function S(a){var c,d,b=e.nquad_flat_uv;b&&(c=a+4*b*Uint32Array.BYTES_PER_ELEMENT,d=c+4*b*Uint32Array.BYTES_PER_ELEMENT,K(b,a,d),I(b,c))}function T(a){var c,d,b=e.nquad_smooth;b&&(c=a+4*b*Uint32Array.BYTES_PER_ELEMENT,d=c+4*b*Uint32Array.BYTES_PER_ELEMENT,M(b,a,c,d))}function U(a){var c,d,f,b=e.nquad_smooth_uv;b&&(c=a+4*b*Uint32Array.BYTES_PER_ELEMENT,d=c+4*b*Uint32Array.BYTES_PER_ELEMENT,f=d+4*b*Uint32Array.BYTES_PER_ELEMENT,M(b,a,c,f),I(b,d))}var e,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,c=this,d=0,f=[],g=[];THREE.Geometry.call(this),e=A(a,d),d+=e.header_bytes,p=3*e.vertex_index_bytes+e.material_index_bytes,q=4*e.vertex_index_bytes+e.material_index_bytes,r=e.ntri_flat*p,s=e.ntri_smooth*(p+3*e.normal_index_bytes),t=e.ntri_flat_uv*(p+3*e.uv_index_bytes),u=e.ntri_smooth_uv*(p+3*e.normal_index_bytes+3*e.uv_index_bytes),v=e.nquad_flat*q,w=e.nquad_smooth*(q+4*e.normal_index_bytes),x=e.nquad_flat_uv*(q+4*e.uv_index_bytes),y=e.nquad_smooth_uv*(q+4*e.normal_index_bytes+4*e.uv_index_bytes),d+=E(d),d+=F(d),d+=z(3*e.nnormals),d+=G(d),h=d,i=h+r+z(2*e.ntri_flat),j=i+s+z(2*e.ntri_smooth),k=j+t+z(2*e.ntri_flat_uv),l=k+u+z(2*e.ntri_smooth_uv),m=l+v+z(2*e.nquad_flat),n=m+w+z(2*e.nquad_smooth),o=n+x+z(2*e.nquad_flat_uv),O(j),Q(k),S(n),U(o),N(h),P(i),R(l),T(m),this.computeFaceNormals()};e.prototype=Object.create(THREE.Geometry.prototype),e.prototype.constructor=e,f=new e(c),g=THREE.Loader.prototype.initMaterials(d,c,this.crossOrigin),b(f,g)}},nextSpawnInterval=function(a){return 2*Math.random()/a},uniformRandom=function(a,b){return a+(b-a)*Math.random()},SpriteParticleSystem=function(a){var b,c,d,e,f;for(THREE.Object3D.call(this),this.cloud=a.cloud,this.rate=void 0!==a.rate?a.rate:3,this.num=void 0!==a.num?a.num:30,this.texture=a.texture,this.scaleR=void 0!==a.scaleR?a.scaleR:[1,10],this.speedR=void 0!==a.speedR?a.speedR:[10,10],this.terminalSpeed=void 0!==a.terminalspeed?a.terminalspeed:null,this.rspeedR=void 0!==a.rspeedR?a.rspeedR:[-.2,.2],this.lifespanR=void 0!==a.lifespanR?a.lifespanR:[3,5],this.forces=[],this.xScaleBase=this.texture.image.width,this.yScaleBase=this.texture.image.height,this.particles=[],this.lastUpdateTime=0,b=new THREE.SpriteMaterial({map:this.texture,useScreenCoordinates:!1,depthWrite:!1,color:16777215,fog:!0}),c=0;c<this.num;++c)d=b.clone(),e=new THREE.Sprite(d),e.visible=!1,this.cloud.add(e),f={},f.sprite=e,f.death=-1,this.particles.push(f);this.nextParticleIndex=0},SpriteParticleSystem.prototype=new THREE.Object3D,SpriteParticleSystem.prototype.constructor=SpriteParticleSystem,SpriteParticleSystem.prototype.addForce=function(a){this.forces.push(a)},SpriteParticleSystem.prototype.spawnOne=function(a){var c,d,e,b=this.particles[this.nextParticleIndex];this.nextParticleIndex=(this.nextParticleIndex+1)%this.particles.length,b.birth=a,b.death=a+uniformRandom(this.lifespanR[0],this.lifespanR[1]),c=b.sprite,c.visible=!0,c.position.setFromMatrixPosition(this.matrixWorld),c.material.rotation=uniformRandom(0,2*Math.PI),b.speed=uniformRandom(this.speedR[0],this.speedR[1]),d=uniformRandom(0,2*Math.PI),e=uniformRandom(-Math.PI,Math.PI),b.vel=new THREE.Vector3,b.vel.x=b.speed*Math.cos(e)*Math.cos(d),b.vel.y=b.speed*Math.cos(e)*Math.sin(d),b.vel.z=b.speed*Math.sin(e),b.rspeed=uniformRandom(this.rspeedR[0],this.rspeedR[1])},SpriteParticleSystem.prototype.start=function(){this.nextSpawnT=this.lastUpdateTime+nextSpawnInterval(this.rate)},SpriteParticleSystem.prototype.stop=function(){this.nextSpawnT=null},SpriteParticleSystem.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k;if(0!==a){for(this.lastUpdateTime+=a,b=this.lastUpdateTime,c=0;c<this.particles.length;++c)if(d=this.particles[c],b>d.death)d.sprite.opacity=0,d.sprite.visible=!1;else{for(e=d.sprite,e.material.rotation+=a*d.rspeed,f=0;f<this.forces.length;f++)g=this.forces[f].clone(),g.multiplyScalar(a),d.vel.add(g);null!==this.terminalSpeed&&(h=d.vel.length(),h>this.terminalSpeed&&d.vel.multiplyScalar(this.terminalSpeed/h)),i=d.vel.clone(),i.multiplyScalar(a),e.position.add(i),j=(b-d.birth)/(d.death-d.birth),k=this.scaleR[0]+j*(this.scaleR[1]-this.scaleR[0]),e.scale.set(k*this.xScaleBase,k*this.yScaleBase,1),e.material.opacity=1-j}for(;this.nextSpawnT&&b>=this.nextSpawnT;)this.spawnOne(this.nextSpawnT),this.nextSpawnT+=nextSpawnInterval(this.rate)}},THREE.OrbitControls=function(a,b){function x(){return 2*Math.PI/60/60*c.autoRotateSpeed}function y(){return Math.pow(.95,c.zoomSpeed)}function z(a){k.theta-=a}function A(a){k.phi-=a}function E(a){c.object instanceof THREE.PerspectiveCamera?l/=a:c.object instanceof THREE.OrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom*a)),c.object.updateProjectionMatrix(),n=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function F(a){c.object instanceof THREE.PerspectiveCamera?l*=a:c.object instanceof THREE.OrthographicCamera?(c.object.zoom=Math.max(c.minZoom,Math.min(c.maxZoom,c.object.zoom/a)),c.object.updateProjectionMatrix(),n=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),c.enableZoom=!1)}function G(a){o.set(a.clientX,a.clientY)}function H(a){u.set(a.clientX,a.clientY)}function I(a){r.set(a.clientX,a.clientY)}function J(a){p.set(a.clientX,a.clientY),q.subVectors(p,o);var b=c.domElement===document?c.domElement.body:c.domElement;z(2*Math.PI*q.x/b.clientWidth*c.rotateSpeed),A(2*Math.PI*q.y/b.clientHeight*c.rotateSpeed),o.copy(p),c.update()}function K(a){v.set(a.clientX,a.clientY),w.subVectors(v,u),w.y>0?E(y()):w.y<0&&F(y()),u.copy(v),c.update()}function L(a){s.set(a.clientX,a.clientY),t.subVectors(s,r),D(t.x,t.y),r.copy(s),c.update()}function M(){}function N(a){a.deltaY<0?F(y()):a.deltaY>0&&E(y()),c.update()}function O(a){switch(a.keyCode){case c.keys.UP:D(0,c.keyPanSpeed),c.update();break;case c.keys.BOTTOM:D(0,-c.keyPanSpeed),c.update();break;case c.keys.LEFT:D(c.keyPanSpeed,0),c.update();break;case c.keys.RIGHT:D(-c.keyPanSpeed,0),c.update()}}function P(a){o.set(a.touches[0].pageX,a.touches[0].pageY)}function Q(a){var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);u.set(0,d)}function R(a){r.set(a.touches[0].pageX,a.touches[0].pageY)}function S(a){p.set(a.touches[0].pageX,a.touches[0].pageY),q.subVectors(p,o);var b=c.domElement===document?c.domElement.body:c.domElement;z(2*Math.PI*q.x/b.clientWidth*c.rotateSpeed),A(2*Math.PI*q.y/b.clientHeight*c.rotateSpeed),o.copy(p),c.update()}function T(a){var b=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY,e=Math.sqrt(b*b+d*d);v.set(0,e),w.subVectors(v,u),w.y>0?F(y()):w.y<0&&E(y()),u.copy(v),c.update()}function U(a){s.set(a.touches[0].pageX,a.touches[0].pageY),t.subVectors(s,r),D(t.x,t.y),r.copy(s),c.update()}function V(){}function W(a){if(c.enabled!==!1){if(a.preventDefault(),a.button===c.mouseButtons.ORBIT){if(c.enableRotate===!1)return;G(a),h=g.ROTATE}else if(a.button===c.mouseButtons.ZOOM){if(c.enableZoom===!1)return;H(a),h=g.DOLLY}else if(a.button===c.mouseButtons.PAN){if(c.enablePan===!1)return;I(a),h=g.PAN}h!==g.NONE&&(document.addEventListener("mousemove",X,!1),document.addEventListener("mouseup",Y,!1),c.dispatchEvent(e))}}function X(a){if(c.enabled!==!1)if(a.preventDefault(),h===g.ROTATE){if(c.enableRotate===!1)return;J(a)}else if(h===g.DOLLY){if(c.enableZoom===!1)return;K(a)}else if(h===g.PAN){if(c.enablePan===!1)return;L(a)}}function Y(a){c.enabled!==!1&&(M(a),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),c.dispatchEvent(f),h=g.NONE)}function Z(a){c.enabled===!1||c.enableZoom===!1||h!==g.NONE&&h!==g.ROTATE||(a.preventDefault(),a.stopPropagation(),N(a),c.dispatchEvent(e),c.dispatchEvent(f))}function $(a){c.enabled!==!1&&c.enableKeys!==!1&&c.enablePan!==!1&&O(a)}function _(a){if(c.enabled!==!1){switch(a.touches.length){case 1:if(c.enableRotate===!1)return;P(a),h=g.TOUCH_ROTATE;break;case 2:if(c.enableZoom===!1)return;Q(a),h=g.TOUCH_DOLLY;break;case 3:if(c.enablePan===!1)return;R(a),h=g.TOUCH_PAN;break;default:h=g.NONE}h!==g.NONE&&c.dispatchEvent(e)}}function ab(a){if(c.enabled!==!1)switch(a.preventDefault(),a.stopPropagation(),a.touches.length){case 1:if(c.enableRotate===!1)return;if(h!==g.TOUCH_ROTATE)return;S(a);break;case 2:if(c.enableZoom===!1)return;if(h!==g.TOUCH_DOLLY)return;T(a);break;case 3:if(c.enablePan===!1)return;if(h!==g.TOUCH_PAN)return;U(a);break;default:h=g.NONE}}function bb(a){c.enabled!==!1&&(V(a),c.dispatchEvent(f),h=g.NONE)}function cb(a){a.preventDefault()}var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,B,C,D;this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.target=new THREE.Vector3,this.minDistance=150,this.maxDistance=300,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI/2.2,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!0,this.dampingFactor=.15,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=.05,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:THREE.MOUSE.LEFT,ZOOM:THREE.MOUSE.MIDDLE,PAN:THREE.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return j.phi},this.getAzimuthalAngle=function(){return j.theta},this.reset=function(){c.target.copy(c.target0),c.object.position.copy(c.position0),c.object.zoom=c.zoom0,c.object.updateProjectionMatrix(),c.dispatchEvent(d),c.update(),h=g.NONE},this.update=function(){var b=new THREE.Vector3,e=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),f=e.clone().inverse(),o=new THREE.Vector3,p=new THREE.Quaternion;return function(){var a=c.object.position;return b.copy(a).sub(c.target),b.applyQuaternion(e),j.setFromVector3(b),c.autoRotate&&h===g.NONE&&z(x()),j.theta+=k.theta,j.phi+=k.phi,j.theta=Math.max(c.minAzimuthAngle,Math.min(c.maxAzimuthAngle,j.theta)),j.phi=Math.max(c.minPolarAngle,Math.min(c.maxPolarAngle,j.phi)),j.makeSafe(),j.radius*=l,j.radius=Math.max(c.minDistance,Math.min(c.maxDistance,j.radius)),c.target.add(m),b.setFromSpherical(j),b.applyQuaternion(f),a.copy(c.target).add(b),c.object.lookAt(c.target),c.enableDamping===!0?(k.theta*=1-c.dampingFactor,k.phi*=1-c.dampingFactor):k.set(0,0,0),l=1,m.set(0,0,0),n||o.distanceToSquared(c.object.position)>i||8*(1-p.dot(c.object.quaternion))>i?(c.dispatchEvent(d),o.copy(c.object.position),p.copy(c.object.quaternion),n=!1,!0):!1}}(),this.dispose=function(){c.domElement.removeEventListener("contextmenu",cb,!1),c.domElement.removeEventListener("mousedown",W,!1),c.domElement.removeEventListener("wheel",Z,!1),c.domElement.removeEventListener("touchstart",_,!1),c.domElement.removeEventListener("touchend",bb,!1),c.domElement.removeEventListener("touchmove",ab,!1),document.removeEventListener("mousemove",X,!1),document.removeEventListener("mouseup",Y,!1),window.removeEventListener("keydown",$,!1)},c=this,d={type:"change"},e={type:"start"},f={type:"end"},g={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},h=g.NONE,i=1e-6,j=new THREE.Spherical,k=new THREE.Spherical,l=1,m=new THREE.Vector3,n=!1,o=new THREE.Vector2,p=new THREE.Vector2,q=new THREE.Vector2,r=new THREE.Vector2,s=new THREE.Vector2,t=new THREE.Vector2,u=new THREE.Vector2,v=new THREE.Vector2,w=new THREE.Vector2,B=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,0),a.multiplyScalar(-b),m.add(a)}}(),C=function(){var a=new THREE.Vector3;return function(b,c){a.setFromMatrixColumn(c,1),a.multiplyScalar(b),m.add(a)}}(),D=function(){var a=new THREE.Vector3;return function(b,d){var f,g,e=c.domElement===document?c.domElement.body:c.domElement;c.object instanceof THREE.PerspectiveCamera?(f=c.object.position,a.copy(f).sub(c.target),g=a.length(),g*=Math.tan(c.object.fov/2*Math.PI/180),B(2*b*g/e.clientHeight,c.object.matrix),C(2*d*g/e.clientHeight,c.object.matrix)):c.object instanceof THREE.OrthographicCamera?(B(b*(c.object.right-c.object.left)/c.object.zoom/e.clientWidth,c.object.matrix),C(d*(c.object.top-c.object.bottom)/c.object.zoom/e.clientHeight,c.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),c.enablePan=!1)}}(),c.domElement.addEventListener("contextmenu",cb,!1),c.domElement.addEventListener("mousedown",W,!1),c.domElement.addEventListener("wheel",Z,!1),c.domElement.addEventListener("touchstart",_,!1),c.domElement.addEventListener("touchend",bb,!1),c.domElement.addEventListener("touchmove",ab,!1),window.addEventListener("keydown",$,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.OrbitControls.prototype.constructor=THREE.OrbitControls,Object.defineProperties(THREE.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(a){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!a}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(a){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!a}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(a){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!a}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(a){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!a}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(a){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!a}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(a){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=a
}}});